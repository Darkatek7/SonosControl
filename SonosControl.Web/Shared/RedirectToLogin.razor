@inject NavigationManager Navigation

<p class="m-3">Redirecting to login...</p>

@code {
    private bool _hasNavigated;

    protected override void OnAfterRender(bool firstRender)
    {
        if (!firstRender || _hasNavigated)
        {
            return;
        }

        _hasNavigated = true;
        var relativePath = Navigation.ToBaseRelativePath(Navigation.Uri);

        if (!string.IsNullOrEmpty(relativePath) && !relativePath.StartsWith("/"))
        {
            relativePath = $"/{relativePath}";
        }

        var target = string.IsNullOrEmpty(relativePath)
            ? "/auth/login"
            : $"/auth/login?returnUrl={Uri.EscapeDataString(relativePath)}";

        Navigation.NavigateTo(target, true);
    }
}
